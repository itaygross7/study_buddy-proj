{% extends "base.html" %}
{% block content %}
<div class="hero">
  <div class="hero-left">
    <!-- Avner big pose on left -->
    <img src="{{ url_for('serve_avner', filename='avner_with_laptop.jpeg') }}" alt="××‘× ×¨ ×”-CapyBuddy ×™×•×©×‘ ××•×œ ×”××—×©×‘" class="avner-hero">
  </div>
  <div class="hero-right">
    <h1>ğŸ‘‹ ×©×œ×•×! ×× ×™ ××‘× ×¨ ×”-CapyBuddy</h1>
    <p class="muted">×›××Ÿ ×›×“×™ ×œ×¢×–×•×¨ ×œ×š ×œ×œ××•×“ ×‘×§×œ×•×ª ×•×‘×›×™×£. ×‘×—×¨ ×›×œ×™, ×”×¢×œ×” ×§×•×‘×¥ ××• ×”×“×‘×§ ×˜×§×¡×˜ ×•×”×ª×—×œ ×œ×œ××•×“!</p>
    
    <!-- Enhanced File Upload Form -->
    <div class="content-card mt-5">
      <form id="uploadForm" action="/api/upload/" method="post" enctype="multipart/form-data" class="space-y-4">
        <div>
          <label for="fileInput" class="block mb-2 font-bold text-dark-brown text-right">ğŸ“ ×”×¢×œ×” ×§×•×‘×¥:</label>
          <input type="file" id="fileInput" name="file" accept=".pdf,.docx,.pptx,.txt,.html,.png,.jpg,.jpeg,.gif" class="form-input">
        </div>
        <div class="text-center text-warm-gray font-medium">
          <span>××•</span>
        </div>
        <div>
          <label for="textInput" class="block mb-2 font-bold text-dark-brown text-right">ğŸ“ ×”×“×‘×§ ×˜×§×¡×˜:</label>
          <textarea id="textInput" name="text" rows="4" class="form-input" placeholder="×”×“×‘×§ ××ª ×”×˜×§×¡×˜ ×©×œ×š ×›××Ÿ..."></textarea>
        </div>
        <button type="submit" class="btn-primary w-full">
          ğŸš€ ×”×¢×œ×” ×•×”×ª×—×œ ×œ×œ××•×“
        </button>
        <div id="uploadStatus" class="mt-3 text-center hidden"></div>
      </form>
    </div>
  </div>
</div>

<div class="tools-grid">
  <!-- Main 4 cards with varied Avner photos -->
  <a href="{{ url_for('summary_tool') }}" class="tool-card tool-link">
    <img src="{{ url_for('serve_avner', filename='avner_reading.jpeg') }}" alt="××‘× ×¨ ×§×•×¨×" class="sticker">
    <h3>ğŸ“– ××¡×›×</h3>
    <p>×§×‘×œ ×¡×™×›×•× ×™×“×™×“×•×ª×™ ×•×××•×§×“ ×œ×˜×§×¡×˜×™× ×•×§×‘×¦×™× ×©×œ×š.</p>
  </a>
  <a href="{{ url_for('flashcards_tool') }}" class="tool-card tool-link">
    <img src="{{ url_for('serve_avner', filename='avner_studing.jpeg') }}" alt="××‘× ×¨ ×œ×•××“" class="sticker">
    <h3>ğŸ´ ×›×¨×˜×™×¡×™×•×ª</h3>
    <p>×™×™×¦×•×¨ ×›×¨×˜×™×¡×™×•×ª ×œ×–×™×›×¨×•×Ÿ ×•×ª×¨×’×•×œ ×××•×§×“.</p>
  </a>
  <a href="{{ url_for('assess_tool') }}" class="tool-card tool-link">
    <img src="{{ url_for('serve_avner', filename='avner_celebrating.jpeg') }}" alt="××‘× ×¨ ×—×•×’×’" class="sticker">
    <h3>âœ… ×‘×—×Ÿ ××•×ª×™</h3>
    <p>×©××œ×•×ª ××™××•×Ÿ ××•×ª×××•×ª ×œ×¨××” ×©×œ×š.</p>
  </a>
  <a href="{{ url_for('homework_tool') }}" class="tool-card tool-link">
    <img src="{{ url_for('serve_avner', filename='avner_thinking.jpeg') }}" alt="××‘× ×¨ ×—×•×©×‘" class="sticker">
    <h3>ğŸ“š ×¢×•×–×¨ ×©×™×¢×•×¨×™×</h3>
    <p>×”×¡×‘×¨×™× ×™×“×™×“×•×ª×™×™× ×•×¦×¢×“Ö¾××¦×¢×“ ×œ×©×™×¢×•×¨×™ ×‘×™×ª.</p>
  </a>
  <!-- Additional tools with more Avner variety -->
  <a href="{{ url_for('tutor_tool') }}" class="tool-card tool-link">
    <img src="{{ url_for('serve_avner', filename='avner_signing_ok.jpeg') }}" alt="××‘× ×¨ ××•×¨×”" class="sticker">
    <h3>ğŸ“ ××•×¨×” ×¤×¨×˜×™ AI</h3>
    <p>×©××œ×• ××•×ª×™ ×›×œ ×“×‘×¨ ×¢×œ ×”×—×•××¨ ×©×œ×›×.</p>
  </a>
  <a href="{{ url_for('diagram_tool') }}" class="tool-card tool-link">
    <img src="{{ url_for('serve_avner', filename='avner_angry_holding_pencile.jpeg') }}" alt="××‘× ×¨ ×¢× ×¢×™×¤×¨×•×Ÿ" class="sticker">
    <h3>ğŸ“Š ×™×¦×™×¨×ª ×ª×¨×©×™××™×</h3>
    <p>×”×¤×™×›×ª ×˜×§×¡×˜ ××•×¨×›×‘ ×œ×ª×¨×©×™× ×•×™×–×•××œ×™ ×¤×©×•×˜.</p>
  </a>
  <a href="{{ url_for('glossary_page', course_id='default') }}" class="tool-card tool-link">
    <img src="{{ url_for('serve_avner', filename='avner_waving.jpeg') }}" alt="××‘× ×¨ ×× ×•×¤×£" class="sticker">
    <h3>ğŸ“š ××•× ×—×•×Ÿ</h3>
    <p>×›×œ ×”××•× ×—×™× ×”×—×©×•×‘×™× ××”×§×•×¨×¡×™× ×©×œ×›× ×‘××§×•× ××—×“.</p>
  </a>
  {% if current_user.is_authenticated %}
  <a href="{{ url_for('library.index') }}" class="tool-card tool-link">
    <img src="{{ url_for('serve_avner', filename='avner_holding_backbak.jpeg') }}" alt="××‘× ×¨ ×¢× ×ª×™×§" class="sticker">
    <h3>ğŸ“š ×”×¡×¤×¨×™×™×” ×©×œ×™</h3>
    <p>× ×™×”×•×œ ×§×•×¨×¡×™× ×•×§×‘×¦×™× ×‘××§×•× ××¨×›×–×™ ××—×“.</p>
  </a>
  {% endif %}
</div>

<script>
// Enhanced upload form handler with friendly messages
document.getElementById('uploadForm').addEventListener('submit', async function(e) {
  e.preventDefault();
  const formData = new FormData(this);
  const statusDiv = document.getElementById('uploadStatus');
  
  statusDiv.classList.remove('hidden');
  statusDiv.innerHTML = '<span class="text-cozy-brown font-medium">â³ ××¢×œ×” ××ª ×”×§×•×‘×¥...</span>';
  
  try {
    const response = await fetch('/api/upload/', {
      method: 'POST',
      body: formData
    });
    
    const data = await response.json();
    
    if (response.ok) {
      statusDiv.innerHTML = '<div class="success-card"><span class="font-bold">âœ… ×”×¦×œ×—×”!</span> ×”×§×•×‘×¥ ' + data.filename + ' ×”×•×¢×œ×” ×‘×”×¦×œ×—×”!</div>';
      this.reset();
    } else {
      statusDiv.innerHTML = '<div class="error-card"><span class="font-bold">âŒ ××•×¤×¡!</span> ' + (data.error || '××©×”×• ×”×©×ª×‘×©. × ×¡×” ×©×•×‘.') + '</div>';
    }
  } catch (error) {
    statusDiv.innerHTML = '<div class="error-card"><span class="font-bold">âŒ ×©×’×™××” ×‘×”×¢×œ××”</span> - ×× × ×‘×“×•×§ ××ª ×”×—×™×‘×•×¨ ×œ××™× ×˜×¨× ×˜ ×•× ×¡×” ×©×•×‘.</div>';
  }
});
</script>
{% endblock %}
