<div id="task-status-{{ task.id }}" 
     hx-get="{{ url_for('task_bp.get_task_status_route', task_id=task.id) }}" 
     hx-trigger="every 2s" 
     hx-swap="outerHTML">

    {% if task.status == 'PENDING' or task.status == 'PROCESSING' %}
    <div class="p-4 rounded-xl bg-cream border-2 border-warm-yellow">
        <div class="flex items-center gap-3">
            <img src="{{ url_for('static', filename='img/avner_thinking.png') }}" 
                 alt="אבנר עובד"
                 class="w-10 h-10 rounded-full object-cover border-2 border-golden-yellow animate-pulse"
                 onerror="this.style.display='none'">
            <div>
                <p class="text-sm font-medium text-dark-brown">
                    {% if task.status == 'PENDING' %}
                    ממתין בתור...
                    {% else %}
                    אבנר מעבד את הבקשה...
                    {% endif %}
                </p>
                <p class="text-sm text-coffee mt-1">
                    אנא המתינו, אבנר עובד על זה.
                </p>
            </div>
        </div>
    </div>
    {% elif task.status == 'COMPLETED' %}
    <div class="p-4 rounded-xl bg-cream border-2 border-success"
         hx-get="{{ url_for('results_bp.get_result', result_id=task.result_id) }}"
         hx-trigger="load"
         hx-target="this"
         hx-swap="innerHTML">
        <div class="flex items-center gap-3">
            <img src="{{ url_for('static', filename='img/avner_celebrate.png') }}" 
                 alt="אבנר חוגג"
                 class="w-10 h-10 rounded-full object-cover border-2 border-success"
                 onerror="this.style.display='none'">
            <p class="text-success font-medium">הושלם! טוען תוצאות...</p>
        </div>
    </div>
    {% elif task.status == 'FAILED' %}
    <div class="p-4 rounded-xl bg-cream border-2 border-error">
        <div class="flex items-start gap-3">
            <img src="{{ url_for('static', filename='img/avner_cry_laugh.png') }}" 
                 alt="אבנר מצטער"
                 class="w-10 h-10 rounded-full object-cover border-2 border-error flex-shrink-0"
                 onerror="this.style.display='none'">
            <div>
                <h3 class="text-sm font-medium text-error">משהו השתבש</h3>
                <p class="mt-1 text-sm text-coffee">{{ task.error_message or 'אירעה שגיאה לא צפויה. נסו שוב.' }}</p>
            </div>
        </div>
    </div>
    {% endif %}
</div>
