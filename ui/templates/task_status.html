<div id="task-status-{{ task.id }}" 
     hx-get="{{ url_for('task_bp.get_task_status_route', task_id=task.id) }}" 
     hx-trigger="every 2s" 
     hx-swap="outerHTML">

    {% if task.status == 'PENDING' or task.status == 'PROCESSING' %}
    <div class="p-4 rounded-xl bg-blue-50 border border-blue-200">
        <div class="flex items-center gap-3">
            <div class="animate-spin rounded-full h-5 w-5 border-b-2 border-hoodie-orange"></div>
            <div>
                <p class="text-sm font-medium text-dark-brown">
                    {% if task.status == 'PENDING' %}
                    ממתין בתור...
                    {% else %}
                    מעבד את הבקשה...
                    {% endif %}
                </p>
                <p class="text-sm text-gray-600 mt-1">
                    אבנר ה-CapyBuddy עובד על זה. אנא המתינו.
                </p>
            </div>
        </div>
    </div>
    {% elif task.status == 'COMPLETED' %}
    <div class="p-4 rounded-xl bg-green-50 border border-success"
         hx-get="{{ url_for('results_bp.get_result', result_id=task.result_id) }}"
         hx-trigger="load"
         hx-target="this"
         hx-swap="innerHTML">
        <div class="flex items-center gap-3">
            <svg class="w-5 h-5 text-success" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5" />
            </svg>
            <p class="text-success font-medium">הושלם! טוען תוצאות...</p>
        </div>
    </div>
    {% elif task.status == 'FAILED' %}
    <div class="p-4 rounded-xl bg-red-50 border border-error">
        <div class="flex items-start gap-3">
            <svg class="w-5 h-5 text-error flex-shrink-0 mt-0.5" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z" />
            </svg>
            <div>
                <h3 class="text-sm font-medium text-error">משהו השתבש</h3>
                <p class="mt-1 text-sm text-red-700">{{ task.error_message or 'אירעה שגיאה לא צפויה. נסו שוב.' }}</p>
            </div>
        </div>
    </div>
    {% endif %}
</div>
