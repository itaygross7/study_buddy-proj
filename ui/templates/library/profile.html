{% extends "base.html" %}

{% block title %}驻专驻 砖 - StudyBuddy{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto">
    <h1 class="text-2xl font-bold text-dark-brown mb-6"> 驻专驻 砖</h1>
    
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    {% for category, message in messages %}
    <div class="mb-4 p-3 rounded-lg {% if category == 'error' %}bg-red-50 text-error{% elif category == 'success' %}bg-green-50 text-success{% else %}bg-warm-beige{% endif %}">
        {{ message }}
    </div>
    {% endfor %}
    {% endif %}
    {% endwith %}
    
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <!-- Stats -->
        <div class="bg-cream rounded-xl p-5 shadow-md border border-warm-yellow text-center">
            <div class="text-3xl mb-2"></div>
            <div class="text-2xl font-bold text-dark-brown">{{ courses_count }}</div>
            <div class="text-sm text-cozy-brown">拽专住</div>
        </div>
        <div class="bg-cream rounded-xl p-5 shadow-md border border-warm-yellow text-center">
            <div class="text-3xl mb-2"></div>
            <div class="text-2xl font-bold text-dark-brown">{{ documents_count }}</div>
            <div class="text-sm text-cozy-brown">住</div>
        </div>
        <div class="bg-cream rounded-xl p-5 shadow-md border border-warm-yellow text-center">
            <div class="text-3xl mb-2">锔</div>
            <div class="text-2xl font-bold text-dark-brown truncate">{{ current_user.user.email }}</div>
            <div class="text-sm text-cozy-brown"></div>
        </div>
    </div>
    
    <!-- Profile Form -->
    <form method="POST" class="mt-6 bg-cream rounded-2xl p-6 shadow-md border border-warm-yellow">
        <h2 class="text-xl font-bold text-dark-brown mb-4">驻专 砖</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
            <div>
                <label class="block text-sm font-medium text-dark-brown mb-1">砖 </label>
                <input type="text" name="full_name" value="{{ profile.full_name }}" class="w-full p-3 border-2 border-warm-gray rounded-xl bg-warm-beige focus:border-golden-yellow focus:outline-none">
            </div>
            <div>
                <label class="block text-sm font-medium text-dark-brown mb-1">驻</label>
                <input type="tel" name="phone" value="{{ profile.phone }}" class="w-full p-3 border-2 border-warm-gray rounded-xl bg-warm-beige focus:border-golden-yellow focus:outline-none">
            </div>
        </div>
        
        <h2 class="text-xl font-bold text-dark-brown mb-4">驻专 住</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
            <div>
                <label class="block text-sm font-medium text-dark-brown mb-1">住 </label>
                <input type="text" name="institution" value="{{ profile.institution }}" placeholder="专住/" class="w-full p-3 border-2 border-warm-gray rounded-xl bg-warm-beige focus:border-golden-yellow focus:outline-none">
            </div>
            <div>
                <label class="block text-sm font-medium text-dark-brown mb-1">转专/</label>
                <input type="text" name="degree" value="{{ profile.degree }}" placeholder="砖: 注 砖" class="w-full p-3 border-2 border-warm-gray rounded-xl bg-warm-beige focus:border-golden-yellow focus:outline-none">
            </div>
            <div>
                <label class="block text-sm font-medium text-dark-brown mb-1">砖转 </label>
                <input type="text" name="year_of_study" value="{{ profile.year_of_study }}" placeholder="砖: 砖 '" class="w-full p-3 border-2 border-warm-gray rounded-xl bg-warm-beige focus:border-golden-yellow focus:outline-none">
            </div>
            <div>
                <label class="block text-sm font-medium text-dark-brown mb-1">砖驻 注驻转</label>
                <select name="preferred_language" class="w-full p-3 border-2 border-warm-gray rounded-xl bg-warm-beige focus:border-golden-yellow focus:outline-none">
                    <option value="he" {% if profile.preferred_language.value == 'he' %}selected{% endif %}>注专转</option>
                    <option value="en" {% if profile.preferred_language.value == 'en' %}selected{% endif %}>English</option>
                </select>
            </div>
        </div>
        
        <h2 class="text-xl font-bold text-dark-brown mb-4">注 专</h2>
        <div class="mb-6">
            <label class="block text-sm font-medium text-dark-brown mb-1">注  砖注专 专 注转  转专</label>
            <textarea name="general_context" rows="3" maxlength="1000" class="w-full p-3 border-2 border-warm-gray rounded-xl bg-warm-beige focus:border-golden-yellow focus:outline-none resize-none" placeholder="砖:    转专 注 转, 注祝 住专 拽爪专...">{{ profile.general_context }}</textarea>
            <p class="text-xs text-cozy-brown mt-1">专 砖转砖 注  砖注 注 砖转</p>
        </div>
        
        <button type="submit" class="w-full bg-golden-yellow text-dark-brown font-bold py-3 rounded-xl hover:bg-warm-yellow transition-colors shadow-md">
             砖专 砖
        </button>
    </form>
    
    <!-- Change Password Section -->
    <div class="mt-6 bg-cream rounded-2xl p-6 shadow-md border border-warm-yellow">
        <h2 class="text-xl font-bold text-dark-brown mb-4"> 砖 住住</h2>
        
        <form method="POST" action="{{ url_for('library.change_password') }}" id="password-form">
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-dark-brown mb-1">住住 转</label>
                    <input type="password" name="current_password" required
                        class="w-full p-3 border-2 border-warm-gray rounded-xl bg-warm-beige focus:border-golden-yellow focus:outline-none">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-dark-brown mb-1">住住 砖</label>
                    <input type="password" name="new_password" required minlength="8"
                        class="w-full p-3 border-2 border-warm-gray rounded-xl bg-warm-beige focus:border-golden-yellow focus:outline-none">
                    <p class="text-xs text-cozy-brown mt-1">驻转 8 转</p>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-dark-brown mb-1">转 住住 砖</label>
                    <input type="password" name="confirm_password" required minlength="8"
                        class="w-full p-3 border-2 border-warm-gray rounded-xl bg-warm-beige focus:border-golden-yellow focus:outline-none">
                </div>
                
                <button type="submit" 
                    class="w-full bg-cozy-brown text-cream font-bold py-3 rounded-xl hover:bg-coffee transition-colors shadow-md">
                     砖 住住
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}
