{% extends "base.html" %}

{% block title %}×”×¡×¤×¨×™×™×” ×©×œ×™ - StudyBuddy{% endblock %}

{% block content %}
<div class="mb-8">
    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
        <div class="flex items-start gap-4">
            <img src="{{ url_for('serve_avner', filename='avner_holding_backbak.jpeg') }}" 
                 alt="××‘× ×¨ ×¢× ×ª×™×§" 
                 class="w-16 h-16 rounded-full object-cover border-4 border-golden-yellow shadow-warm">
            <div>
                <h1 class="text-3xl md:text-4xl font-bold text-dark-brown">ğŸ“š ×”×¡×¤×¨×™×™×” ×©×œ×™</h1>
                <p class="text-cozy-brown mt-1">×›××Ÿ × ××¦××™× ×›×œ ×”×§×•×¨×¡×™× ×•×”×—×•××¨×™× ×©×œ×š</p>
            </div>
        </div>
        <div class="flex gap-3">
            <a href="{{ url_for('library.profile') }}" 
               class="btn-secondary">
                ğŸ‘¤ ×”×¤×¨×•×¤×™×œ ×©×œ×™
            </a>
            {% if current_user.user.role.value == 'admin' or courses|length < max_courses %}
            <a href="{{ url_for('library.new_course') }}" 
               class="btn-primary shadow-warm">
                â• ×§×•×¨×¡ ×—×“×©
            </a>
            {% endif %}
        </div>
    </div>
</div>

<!-- Quick Start Guide (shown if no courses) -->
{% if courses|length == 0 %}
<div class="content-card text-center border-2 border-golden-yellow mb-8">
    <img src="{{ url_for('serve_avner', filename='avner_reading.jpeg') }}" 
         alt="××‘× ×¨ ×§×•×¨×" 
         class="w-24 h-24 rounded-full mx-auto mb-4 object-cover border-4 border-warm-yellow shadow-warm">
    <h2 class="text-2xl font-bold text-dark-brown mb-3">×‘×¨×•×›×™× ×”×‘××™×! ğŸ¦«</h2>
    <p class="text-cozy-brown mb-6 max-w-lg mx-auto text-lg">
        ×–×” ×”××§×•× ×œ××¨×’×Ÿ ××ª ×›×œ ×—×•××¨×™ ×”×œ×™××•×“ ×©×œ×š.<br>
        ×¦×•×¨ ×§×•×¨×¡ ×—×“×© ×•×”×¢×œ×” ××œ×™×• ××ª ×”×—×•××¨×™× - ×•××‘× ×¨ ×™×¢×–×•×¨ ×œ×š ×œ×œ××•×“!
    </p>
    
    <div class="info-card max-w-md mx-auto text-right mb-6">
        <h3 class="font-bold text-dark-brown mb-3 text-lg">âœ¨ ××™×š ×–×” ×¢×•×‘×“?</h3>
        <ol class="space-y-3 text-sm text-coffee">
            <li class="flex items-start gap-3">
                <span class="font-bold text-golden-yellow text-lg">1.</span>
                <span>×¦×•×¨ ×§×•×¨×¡ ×—×“×© (×œ××©×œ: "××‘×•× ×œ×¤×¡×™×›×•×œ×•×’×™×”")</span>
            </li>
            <li class="flex items-start gap-3">
                <span class="font-bold text-golden-yellow text-lg">2.</span>
                <span>×”×¢×œ×” ×—×•××¨×™ ×œ×™××•×“ - ×¡×™×›×•××™×, ××¦×’×•×ª, PDF</span>
            </li>
            <li class="flex items-start gap-3">
                <span class="font-bold text-golden-yellow text-lg">3.</span>
                <span>×”×©×ª××© ×‘×›×œ×™×: ×¡×™×›×•×, ×›×¨×˜×™×¡×™×•×ª, ×‘×—×™× ×•×ª</span>
            </li>
            <li class="flex items-start gap-3">
                <span class="font-bold text-golden-yellow text-lg">4.</span>
                <span>×©××œ ××ª ××‘× ×¨ ×©××œ×•×ª ×¢×œ ×”×—×•××¨!</span>
            </li>
        </ol>
    </div>
    
    <a href="{{ url_for('library.new_course') }}" 
       class="btn-primary inline-flex items-center gap-2 px-8 py-4 text-lg shadow-warm-lg">
        â• ×¦×•×¨ ××ª ×”×§×•×¨×¡ ×”×¨××©×•×Ÿ ×©×œ×š
    </a>
</div>
{% else %}

<!-- Courses Grid -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    {% for course in courses %}
    <a href="{{ url_for('library.course_page', course_id=course.id) }}" 
       class="content-card content-card-hover"
       style="border-left: 4px solid {{ course.color }}">
        
        <div class="flex items-start justify-between mb-4">
            <div class="text-5xl">{{ course.icon }}</div>
            {% if course.has_content() %}
            <span class="px-3 py-1 bg-success text-white text-xs rounded-full font-medium shadow-sm">âœ… ×¤×¢×™×œ</span>
            {% else %}
            <span class="px-3 py-1 bg-warning text-dark-brown text-xs rounded-full font-medium shadow-sm">â³ ×¨×™×§</span>
            {% endif %}
        </div>
        
        <h3 class="text-xl font-bold text-dark-brown mb-2 line-clamp-2">{{ course.name }}</h3>
        
        {% if course.description %}
        <p class="text-sm text-cozy-brown mb-4 line-clamp-2">{{ course.description }}</p>
        {% endif %}
        
        <div class="flex items-center gap-4 text-xs text-warm-gray border-t border-warm-beige pt-3">
            <span class="flex items-center gap-1">
                <span class="text-base">ğŸ“„</span>
                {{ course.document_count }} ××¡××›×™×
            </span>
            <span class="flex items-center gap-1">
                <span class="text-base">ğŸŒ</span>
                {{ '×¢×‘×¨×™×ª' if course.language.value == 'he' else 'English' }}
            </span>
        </div>
        
        {% if not course.has_content() %}
        <div class="mt-4 info-card text-center py-3">
            <p class="text-sm text-cozy-brown font-medium">ğŸ“¤ ×”×¢×œ×” ×—×•××¨×™× ×›×“×™ ×œ×”×ª×—×™×œ</p>
        </div>
        {% endif %}
    </a>
    {% endfor %}
    
    <!-- Add Course Card -->
    {% if current_user.user.role.value == 'admin' or courses|length < max_courses %}
    <a href="{{ url_for('library.new_course') }}" 
       class="content-card border-2 border-dashed border-warm-gray hover:border-golden-yellow transition-all flex flex-col items-center justify-center min-h-[250px] group bg-warm-beige">
        <div class="text-6xl mb-3 group-hover:scale-110 transition-transform">â•</div>
        <span class="text-cozy-brown font-bold text-lg group-hover:text-dark-brown">×”×•×¡×£ ×§×•×¨×¡ ×—×“×©</span>
        {% if current_user.user.role.value == 'admin' %}
        <span class="text-xs text-warm-gray mt-2">{{ courses|length }} ×§×•×¨×¡×™× (×× ×”×œ - ×œ×œ× ×”×’×‘×œ×”)</span>
        {% else %}
        <span class="text-xs text-warm-gray mt-2">{{ courses|length }}/{{ max_courses }}</span>
        {% endif %}
    </a>
    {% endif %}
</div>

{% endif %}

<!-- Usage Tips -->
<div class="mt-8 info-card flex items-start gap-4">
    <img src="{{ url_for('serve_avner', filename='avner_thinking.jpeg') }}" 
         alt="××‘× ×¨ ×—×•×©×‘" 
         class="w-12 h-12 rounded-full object-cover border-2 border-golden-yellow flex-shrink-0">
    <div>
        <p class="text-sm text-dark-brown font-bold mb-1">ğŸ’¡ ×˜×™×¤ ×××‘× ×¨:</p>
        <p class="text-sm text-cozy-brown">
            ×”×¢×œ×” ××ª ×›×œ ×”×—×•××¨×™× ×©×œ ×§×•×¨×¡ ×œ×ª×™×§×™×™×” ××—×ª. ×›×›×” ×× ×™ ×™×›×•×œ ×œ×¢× ×•×ª ×¢×œ ×©××œ×•×ª ××›×œ ×”×—×•××¨ ×•×œ×¢×–×•×¨ ×œ×š ×œ×œ××•×“ ×˜×•×‘ ×™×•×ª×¨!
        </p>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Initialize welcome Avner
    document.addEventListener('DOMContentLoaded', function() {
        const welcomeContainer = document.getElementById('welcome-avner');
        if (welcomeContainer && typeof AvnerAvatar !== 'undefined') {
            new AvnerAvatar('welcome-avner', { size: 'large', showBubble: false });
        }
    });
</script>
{% endblock %}
