{% extends "base.html" %}
{% block content %}
<div class="hero">
  <div class="hero-left">
    <!-- Avner big pose on left -->
    <img src="/avner/avner_with_laptop.jpeg" alt="אבנר ה-CapyBuddy יושב מול המחשב" class="avner-hero">
  </div>
  <div class="hero-right">
    <h1>שלום! אני אבנר ה-CapyBuddy — כאן כדי לעזור לך ללמוד בקלות.</h1>
    <p class="muted">בחר כלי, העלה קובץ או הדבק טקסט והתחל ללמוד.</p>
    
    <!-- Simple File Upload Form -->
    <div style="margin-top: 20px; padding: 20px; background: white; border-radius: 8px;">
      <form id="uploadForm" action="/api/upload/" method="post" enctype="multipart/form-data" style="text-align: right;">
        <div style="margin-bottom: 10px;">
          <label for="fileInput" style="display: block; margin-bottom: 5px; font-weight: bold;">העלה קובץ:</label>
          <input type="file" id="fileInput" name="file" accept=".pdf,.docx,.pptx,.txt,.html,.png,.jpg,.jpeg,.gif" style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
        </div>
        <div style="margin-bottom: 10px;">
          <label for="textInput" style="display: block; margin-bottom: 5px; font-weight: bold;">או הדבק טקסט:</label>
          <textarea id="textInput" name="text" rows="4" style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;" placeholder="הדבק את הטקסט שלך כאן..."></textarea>
        </div>
        <button type="submit" style="background: #6b5a4a; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; font-weight: bold;">העלה</button>
        <div id="uploadStatus" style="margin-top: 10px; display: none;"></div>
      </form>
    </div>
  </div>
</div>

<div class="tools-grid">
  <!-- 4 cards; correct Avner stickers and alt text -->
  <a href="/summarizer" class="tool-card tool-link">
    <img src="/avner/avner_thinking.jpeg" alt="אבנר ה-CapyBuddy חושב" class="sticker">
    <h3>מסכם</h3>
    <p>קבל סיכום ידידותי וממוקד לטקסטים וקבצים.</p>
  </a>
  <a href="/flashcards" class="tool-card tool-link">
    <img src="/avner/avner_reading.jpeg" alt="אבנר ה-CapyBuddy עם ספר" class="sticker">
    <h3>כרטיסיות</h3>
    <p>ייצור כרטיסיות לזיכרון ותרגול ממוקד.</p>
  </a>
  <a href="/assess" class="tool-card tool-link">
    <img src="/avner/avner_celebrating.jpeg" alt="אבנר ה-CapyBuddy חוגג" class="sticker">
    <h3>בחן אותי</h3>
    <p>שאלות אימון מותאמות לרמה שלך.</p>
  </a>
  <a href="/homework" class="tool-card tool-link">
    <img src="/avner/avner_studing.jpeg" alt="אבנר ה-CapyBuddy מלמד" class="sticker">
    <h3>עוזר שיעורים</h3>
    <p>הסברים ידידותיים וצעד־אצעד לשיעורי בית.</p>
  </a>
</div>

<script>
// Simple upload form handler
document.getElementById('uploadForm').addEventListener('submit', async function(e) {
  e.preventDefault();
  const formData = new FormData(this);
  const statusDiv = document.getElementById('uploadStatus');
  
  statusDiv.style.display = 'block';
  statusDiv.innerHTML = 'מעלה...';
  statusDiv.style.color = '#6b5a4a';
  
  try {
    const response = await fetch('/api/upload/', {
      method: 'POST',
      body: formData
    });
    
    const data = await response.json();
    
    if (response.ok) {
      statusDiv.innerHTML = '✓ הועלה בהצלחה! ' + data.filename;
      statusDiv.style.color = 'green';
      this.reset();
    } else {
      statusDiv.innerHTML = '✗ שגיאה: ' + (data.error || 'משהו השתבש');
      statusDiv.style.color = 'red';
    }
  } catch (error) {
    statusDiv.innerHTML = '✗ שגיאה בהעלאה';
    statusDiv.style.color = 'red';
  }
});
</script>
{% endblock %}
